/*!
 * jQuery fancyTable plugin v1.0.16
 * https://github.com/myspace-nu
 *
 * Copyright 2018 Johan Johansson
 * Released under the MIT license
 */

!function(o){o.fn.fancyTable=function(a){var s=o.extend({inputStyle:"",inputPlaceholder:"Search...",pagination:!1,paginationClass:"btn btn-light",paginationClassActive:"active",pagClosest:3,perPage:10,sortable:!0,searchable:!0,onInit:function(){},onUpdate:function(){},testing:!1},a),i=this;return this.tableUpdate=function(n){if(n.fancyTable.matches=0,o(n).find("tbody tr").each(function(){var a=0,e=!0,t=!1;o(this).find("td").each(function(){s.globalSearch||!n.fancyTable.searchArr[a]||new RegExp(n.fancyTable.searchArr[a],"i").test(o(this).html())?!s.globalSearch||n.fancyTable.search&&!new RegExp(n.fancyTable.search,"i").test(o(this).html())||Array.isArray(s.globalSearchExcludeColumns)&&s.globalSearchExcludeColumns.includes(a+1)||(t=!0):e=!1,a++}),s.globalSearch&&t||!s.globalSearch&&e?(n.fancyTable.matches++,!s.pagination||n.fancyTable.matches>n.fancyTable.perPage*(n.fancyTable.page-1)&&n.fancyTable.matches<=n.fancyTable.perPage*n.fancyTable.page?o(this).show():o(this).hide()):o(this).hide()}),n.fancyTable.pages=Math.ceil(n.fancyTable.matches/n.fancyTable.perPage),s.pagination){var a=n.fancyTable.paginationElement?o(n.fancyTable.paginationElement):o(n).find(".pag");a.empty();for(var e=1;e<=n.fancyTable.pages;e++)if(1==e||e>n.fancyTable.page-(s.pagClosest+1)&&e<n.fancyTable.page+(s.pagClosest+1)||e==n.fancyTable.pages){var t=o("<a>",{html:e,"data-n":e,style:"margin:0.2em",class:s.paginationClass+" "+(e==n.fancyTable.page?s.paginationClassActive:"")}).css("cursor","pointer").bind("click",function(){n.fancyTable.page=o(this).data("n"),i.tableUpdate(n)});e==n.fancyTable.pages&&n.fancyTable.page<n.fancyTable.pages-s.pagClosest-1&&a.append(o("<span>...</span>")),a.append(t),1==e&&n.fancyTable.page>s.pagClosest+2&&a.append(o("<span>...</span>"))}}s.onUpdate.call(this,n)},this.tableSort=function(l){if(void 0!==l.fancyTable.sortColumn&&l.fancyTable.sortColumn<l.fancyTable.nColumns){o(l).find("thead th div.sortArrow").each(function(){o(this).remove()});var a=o("<div>",{class:"sortArrow"}).css({margin:"0.1em",display:"inline-block",width:0,height:0,"border-left":"0.4em solid transparent","border-right":"0.4em solid transparent"});a.css(0<l.fancyTable.sortOrder?{"border-top":"0.4em solid #000"}:{"border-bottom":"0.4em solid #000"}),o(l).find("thead th a").eq(l.fancyTable.sortColumn).append(a);var e=o(l).find("tbody tr").toArray().sort(function(a,e){var t=o(a).find("td").eq(l.fancyTable.sortColumn).html(),n=o(e).find("td").eq(l.fancyTable.sortColumn).html();return"numeric"==l.fancyTable.sortAs[l.fancyTable.sortColumn]?0<l.fancyTable.sortOrder?parseFloat(t)-parseFloat(n):parseFloat(n)-parseFloat(t):t<n?-l.fancyTable.sortOrder:n<t?l.fancyTable.sortOrder:0});o(l).find("tbody").empty().append(e)}},this.each(function(){if("TABLE"!==o(this).prop("tagName"))return console.warn("fancyTable: Element is not a table."),!0;var t=this;if(t.fancyTable={nColumns:o(t).find("td").first().parent().find("td").length,nRows:o(this).find("tbody tr").length,perPage:s.perPage,page:1,pages:0,matches:0,searchArr:[],search:"",sortColumn:s.sortColumn,sortOrder:void 0===s.sortOrder?1:new RegExp("desc","i").test(s.sortOrder)||-1==s.sortOrder?-1:1,sortAs:[],paginationElement:s.paginationElement},0==o(t).find("tbody").length){var a=o(t).html();o(t).empty(),o(t).append("<tbody>").append(o(a))}if(0==o(t).find("thead").length&&o(t).prepend(o("<thead>")),s.sortable){var n=0;o(t).find("thead th").each(function(){t.fancyTable.sortAs.push("numeric"==o(this).data("sortas")?"numeric":"");var a=o(this).html(),e=o("<a>",{html:a,"data-n":n,class:""}).css("cursor","pointer").bind("click",function(){t.fancyTable.sortColumn==o(this).data("n")?t.fancyTable.sortOrder=-t.fancyTable.sortOrder:t.fancyTable.sortOrder=1,t.fancyTable.sortColumn=o(this).data("n"),i.tableSort(t),i.tableUpdate(t)});o(this).empty(),o(this).append(e),n++})}if(s.searchable){var l=o("<tr>");if(s.globalSearch){var e=o("<input>",{placeholder:s.inputPlaceholder,style:"width:100%;"+s.inputStyle}).bind("change paste keyup",function(){t.fancyTable.search=o(this).val(),i.tableUpdate(t)}),r=o("<th>",{style:"padding:2px;"}).attr("colspan",t.fancyTable.nColumns);o(e).appendTo(o(r)),o(r).appendTo(o(l))}else{n=0;o(t).find("td").first().parent().find("td").each(function(){t.fancyTable.searchArr.push("");var a=o("<input>",{"data-n":n,placeholder:s.inputPlaceholder,style:"width:100%;"+s.inputStyle}).bind("change paste keyup",function(){t.fancyTable.searchArr[o(this).data("n")]=o(this).val(),i.tableUpdate(t)}),e=o("<th>",{style:"padding:2px;"});o(a).appendTo(o(e)),o(e).appendTo(o(l)),n++})}l.appendTo(o(t).find("thead"))}i.tableSort(t),s.pagination&&!s.paginationElement&&(o(t).find("tfoot").remove(),o(t).append(o("<tfoot><tr></tr></tfoot>")),o(t).find("tfoot tr").append(o("<td class='pag'></td>",{}).attr("colspan",t.fancyTable.nColumns))),i.tableUpdate(t),s.onInit.call(this,t)}),this}}(jQuery);